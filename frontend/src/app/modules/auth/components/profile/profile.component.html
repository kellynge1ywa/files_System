<div class="home-container">
  <div class="nav ml-10 mt-4">
    <div class="flex items-center ml-6">
      <img
        src="../../../assets/image/phile-logo.jpeg"
        alt=""
        width="40"
        class="m-2"
      />
      <div>
        <span>Phile</span>
      </div>
    </div>

    <div class="mt-6">
      <nav class="">
        <ul class="grid ml-7 gap-4">
          <li>
            <a routerLink="/">Home</a>
          </li>

          <li>
            <a class="">Starred</a>
          </li>

          <li>
            <a class="">Bin</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="main">
    <div>
      <div class="m-4 flex items-center justify-between">
        <div>
          <input
            type="text"
            placeholder="Search"
            class="p-1 pl-2 rounded-[4rem]"
          />
        </div>

        <ng-container *ngIf="currentUser$ | async as user; else login">
          <div
            class="cursor-pointer flex gap-2"
            [mat-menu-trigger-for]="userMenu"
          >
            <img
              class="w-[30px] h-[30px] rounded-[50%] object-cover object-center"
              width="30"
              height="30"
              [src]="user.photoURL ?? 'assets/image/user.png'"
              alt=""
            />
            <div>{{ user.displayName }}</div>

            <mat-icon class="mb-5">expand_more</mat-icon>
          </div>
          <!-- <span>{{ user.email }}</span> -->
        </ng-container>
        <!-- <div>
          <span *ngIf="user$ | async; user">{{ user.email }}</span>
        </div> -->

        <ng-template #login>
          <button mat-button routerLink="/auth/login" class="cursor-pointer">
            <mat-icon>login</mat-icon>
            Login
          </button>
        </ng-template>

        <mat-menu #userMenu="matMenu">
          <button mat-menu-item routerLink="/auth/profile">Profile</button>
          <button mat-menu-item (click)="logout()">Logout</button>
        </mat-menu>
      </div>
    </div>
    <div
      class="text-center border-2 rounded-[2rem] w-[45%] flex flex-col items-center"
      *ngIf="user$ | async as user"
    >
      <h1>User Profile</h1>
      <div class="relative">
        <img
          class="rounded-[100%] object-cover object-center"
          width="120"
          height="120"
          [src]="user.photoURL ?? 'assets/image/user.png'"
          alt=""
        />
        <button
          mat-mini-fab
          (click)="inputField.click()"
          class="absolute bottom-3 left-[6.5rem]"
        >
          <mat-icon>edit</mat-icon>
        </button>
      </div>
      <input
        #inputField
        type="file"
        hidden
        (change)="uploadImage($event, user)"
      />

      <form [formGroup]="profileForm" (ngSubmit)="SaveProfile()" class="mb-5">
        <div class="flex gap-4">
          <div>
            <mat-form-field>
              <mat-label>Enter your full name</mat-label>
              <input
                type="text"
                matInput
                placeholder="John Doe"
                formControlName="fullname"
              />
            </mat-form-field>
          </div>

          <div>
            <mat-form-field>
              <mat-label>Enter your username</mat-label>
              <input
                type="text"
                matInput
                placeholder="Doe"
                formControlName="displayName"
              />
            </mat-form-field>
          </div>
        </div>

        <div class="flex gap-4">
          <div>
            <mat-form-field>
              <mat-label>Enter your email</mat-label>
              <input
                type="email"
                matInput
                placeholder="johndoe@gmail.com"
                formControlName="email"
              />
            </mat-form-field>
          </div>

          <div>
            <mat-form-field>
              <mat-label>Enter your phone number</mat-label>
              <input
                type="number"
                matInput
                placeholder="0712345678"
                formControlName="phoneNumber"
              />
            </mat-form-field>
          </div>
        </div>

        <div class="flex gap-4">
          <div>
            <mat-form-field>
              <mat-label>Enter your residence</mat-label>
              <input
                type="text"
                matInput
                placeholder="Kitale"
                formControlName="residence"
              />
            </mat-form-field>
          </div>

          <div>
            <mat-form-field class="example-full-width">
              <mat-label>Choose a date</mat-label>
              <input
                matInput
                [matDatepicker]="picker"
                placeholder="MM/DD/YYYY"
              />

              <mat-datepicker-toggle matIconSuffix [for]="picker">
                <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
              </mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>
        </div>
        <button class="bg-slate-500 w-[95%] rounded-[0.5rem] p-1">Save</button>
      </form>
    </div>
  </div>
</div>
